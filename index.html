<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0">
    <link rel="icon" type="image/x-icon" href="./styles/icon.png">
    <link rel="stylesheet" href="./styles/style.css">
    <link rel="stylesheet" href="./styles/data.css">
    <link rel="stylesheet" href="./styles/text.css">
    <link rel="stylesheet" href="./styles/reactive.css">
    <link rel="stylesheet" href="./styles/icons.css">
    <link rel="stylesheet" href="./fonts/stylesheet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
    <script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script>
    <script src="https://unpkg.com/twemoji@latest/dist/twemoji.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.0/color-thief.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.2/chroma.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>

<style>
.noselect {
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Old versions of Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none; /* Non-prefixed version, currently */
}

.disabledrag {
   -webkit-user-drag: none;
  -khtml-user-drag: none;
  -moz-user-drag: none;
  -o-user-drag: none;
   -user-drag: none;
}

::-webkit-scrollbar {
  width: 0px;
  height: 0px;
}
::-webkit-scrollbar-track {
  border-radius: 8px;
}
 
::-webkit-scrollbar-thumb {
  border-radius: 8px;
}

::-webkit-scrollbar-thumb:hover {
  border-radius: 8px; 
}

.clickable {display: block;}
</style>

<script>
  let isReloaded = false;

  function checkWindowSize() {
    if (window.innerWidth <= 550 && !isReloaded) {
      console.log('ðŸ”„ loading mobile...');
      localStorage.removeItem('tabs_oritentation');
      isReloaded = true;
      location.reload();
    } else if (window.innerWidth > 550) {
      isReloaded = false; // Reset flag if window size is larger than 550
    }
  }

  // Add event listener for window resize, only once
  window.addEventListener('resize', _.debounce(checkWindowSize, 1000));
</script>

</head>
<body id="body" class="noselect">

  <div id="main_wrapper">
    <div id="main">

      <div id="left_wrapper">
          <div id="left">
            <img id="avatar" class="disabledrag" src="./styles/blank.png"></img>

              <div id="accounts">
                <div class="connection-div"><span class="icons8-loader icon-loader-style"></span></div>
                <div class="connection-div"><span class="icons8-loader icon-loader-style"></span></div>
                <div class="connection-div"><span class="icons8-loader icon-loader-style"></span></div>
                <div class="connection-div"><span class="icons8-loader icon-loader-style"></span></div>
                <div class="connection-div"><span class="icons8-loader icon-loader-style"></span></div>
                <div class="connection-div"><span class="icons8-loader icon-loader-style"></span></div>
                <div class="connection-div"><span class="icons8-loader icon-loader-style"></span></div>
              </div>

                  <div id="music">
                      <a id="link_wrapper" target="_blank">
                        <div id="music_progress_bar_back">
                        <div id="music_progress_bar"></div>
                      </div>
                          <img id="music_cover" class="disabledrag" src="./styles/blank.png"></img>
                      </a>

                      <div id="music_bottom_extender">
                        <div id="music_bottom">
                      <div id="music_bottom_inner">

                      <a id="music_link_wrapper" target="_blank">
                        <div id="music_song"></div>
                        <span id="music_platform"></span>
                      </a>
                        <div id="music_artist"></div>

                      </div>
                    </div>
                  </div>

                  </div>
            </div>
      </div>

      <div id="right_side">

        <div id="settings">
          <div id="settings_button">
            <span id="settings_but_spin" class="icons8-settings settings-style"></span>
          </div>
        </div>
  
          <div id="settings_page">
  
            <span class="setting_pill">
              <span id="sidebar_oritentation_text" style="border-bottom: 2px solid var(--text);">sidebar oritentation</span>
              <div id="sidebar_oritentation" class="settings_button"></div>
              <div id="sidebar_oritentation_mobile" style="display: none;" class="settings_button"></div></span>
            </span>
  
            <span id="bug" class="setting_pill">
              <span style="border-bottom: 2px solid var(--text);">broken?
              <div id="reset" class="settings_button">reset</div></span>
            </span>
          </div>

        <div id="right_wrapper">
          <div class="bar" id="text_outer">
            <div class="noselect bar_inner" id="text"></div>

            <div id="lastfm_mobile" class="title_text" style="width: fit-content;margin-top: 10px;display:none;">
              load data
            </div>
            <div id="hide_if_mobile">
              <div id="lastfm_user" class="user_data"></div>

                  <div style="margin-top: 20px;"><span class="title_text_data">/recent</span>
                <div class="data_outer" id="lastfm_recent_outer">
                  <div class="data_button_container">
                    <button class="data_button" id="recent_left"><span style="left:-1px;position: relative;"> < </span></button>
                    <button class="data_button" id="recent_right"><span style="right:-1px;position: relative;"> > </span></button>
                  </div>
                    <div class="data_move" id="spotify_recent"></div>
                </div>
              </div>

              <div style="margin-top: 20px;"><span class="title_text_data">/liked</span>
                <div class="data_outer" id="lastfm_liked_outer">
                  <div class="data_button_container">
                    <button class="data_button" id="liked_left"><span style="left:-1px;position: relative;"> < </span></button>
                    <button class="data_button" id="liked_right"><span style="right:-1px;position: relative;"> > </span></button>
                  </div>
                    <div class="data_move" id="spotify_liked"></div>
                </div>
                </div>
        
                <div style="margin-top: 20px;"><span class="title_text_data">/top</span>
                  <div class="data_outer" id="lastfm_top_outer">
                    <div class="data_button_container">
                      <button class="data_button" id="top_left"><span style="left:-1px;position: relative;"> < </span></button>
                      <button class="data_button" id="top_right"><span style="right:-1px;position: relative;"> > </span></button>
                    </div>
                      <div class="data_move" id="spotify_top"></div>
                  </div>
                  </div> 
        
                  <div style="margin-top: 20px;margin-bottom: 10px;"><span class="title_text_data">/artists</span>
                  <div class="data_outer" id="lastfm_artist_outer">
                    <div class="data_button_container">
                      <button class="data_button" id="artist_left"><span style="left:-1px;position: relative;"> < </span></button>
                      <button class="data_button" id="artist_right"><span style="right:-1px;position: relative;"> > </span></button>
                    </div>
                      <div class="data_move" id="spotify_artists"></div>
                  </div>
                  </div> 

                <div class="info" id="top_songs_info">
                  <span>fetched from </span>
                  <a style="text-decoration: underline;" href="https://www.last.fm/api" target="_blank">last.fm</a> &
                  <a style="text-decoration: underline;" href="https://developer.spotify.com/documentation/web-api" target="_blank">spotify.com</a>
                  <div id="userdata_lastfmspotify"></div>
                </div>


                <div class="divider" style="margin-bottom: 10px;margin-top: 10px;"></div>
        
                  <div id="games_user" class="user_data"></div>
                  <div class="data_outer" id="games_outer">
                    <div class="data_button_container">
                      <button class="data_button" id="games_left"><span style="left:-1px;position: relative;"> < </span></button>
                      <button class="data_button" id="games_right"><span style="right:-1px;position: relative;"> > </span></button>
                    </div>
                      <div class="data_move" id="games_data"></div>
                  </div>
        
                  <div class="info" id="games_and_activities_info">
                    <span>fetched from </span>
                    <a style="text-decoration: underline;" href="https://developer.valvesoftware.com/wiki/Steam_Web_API#GetOwnedGames_.28v0001.29" target="_blank">steamcommunity.com</a>
                    <div id="userdata_steam"></div>
                  </div>
        
                <div class="divider" style="margin-top: 10px;"></div>
                
                  <div id="waka_user" class="user_data"></div>
                <div id="waka_lang"></div>
                  <div class="info" id="top_languages_info">
                  <span>fetched from </span>
                  <a style="text-decoration: underline;" href="https://wakatime.com" target="_blank">wakatime.com</a>
                  <div id="userdata_wakatime"></div>
                </div>

                <div class="divider" style="margin-top: 10px;margin-bottom: 20px;"></div>
              </div>

              <div id="gallery_mobile" class="title_text" style="width: fit-content;display: none;">load gallery</div>

              <div id="gallery_main">
                <div id="gallery_text" style="margin-top: 20px;"><span class="title_text_data" style="margin-bottom: 6px;width: calc(100% - 6px);">/gallery</span>
                <div id="gallery_outer_1">
                  <div class="noselect bar_outer" id="gallery_outer">
                    <div class="noselect bar_inner inner_scrollables gallery_inner" id="gallery_inner">
                      <div id="column1" class="gallery_column"></div>
                      <div id="column2" class="gallery_column"></div>
                      <div id="mobile_column" style="display: none;"></div>
                    </div>
                  </div>
                </div>
              </div>

            
          </div>
          </div>
        </div>
      </div>

    </div>
  </div>

<script> // reset button
  // use button id to reset localstorage or anything saved in the browser and reload the page
  document.getElementById('reset').addEventListener('click', function () {
  // Clear localStorage
  localStorage.clear();
  // Clear sessionStorage
  sessionStorage.clear();
  // Reload the page
  location.reload();
  });
</script>
<script>
  // profile hover
  // Get references to the profile elements
  const profile = document.getElementById('avatar');
  const pfp = document.getElementById('settings_but_spin');
  const profileHover = document.getElementById('settings_page');

  // Function to toggle the visibility of the profile_hover div
  function toggleProfileHover() {
    if (profileHover.style.display === 'block') {
      profileHover.style.display = 'none';
      pfp.style.animation = 'spinBack 0.3s ease-out forwards'; // Spin back animation
    } else {
      profileHover.style.display = 'block';
      pfp.style.animation = 'spin 0.3s ease-out forwards'; // Spin animation
    }
  }

  // Event listener to show or hide profile_hover when clicking on pfp
  pfp.addEventListener('click', function (event) {
    event.stopPropagation(); // Prevent event bubbling to the document click listener
    toggleProfileHover();
  });

  // Function to hide the profile_hover div
  function hideProfileHover() {
    profileHover.style.display = 'none';
  }

  // Function to show the profile_hover div
  function showProfileHover() {
    profileHover.style.display = 'block';
  }
</script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Function to get days difference
    function getDays(date) {
    const unix = Math.floor(date.getTime() / 1000);
    const currentUnix = Math.floor(Date.now() / 1000);
    const difference = currentUnix - unix;
    const days = Math.floor(difference / 86400);

    if (days > 365) {
      let years = Math.floor(days / 365);
      const remainingDays = days % 365;
      const leapDays = Math.floor(remainingDays / 366); // Number of leap days in remaining days

    if (leapDays > 0) {
      // Adjust years and remaining days considering leap years
      const leapYearDays = leapDays * 366;
      const nonLeapYearDays = remainingDays - leapYearDays;

      years += leapDays;
      const months = Math.floor(nonLeapYearDays / 30);
      const daysLeft = nonLeapYearDays % 30;

if (years > 2) {
return ` (${years}yrs, ${months}mo, ${daysLeft}d)`;
} else {
return ` (${years}yr, ${months}mo, ${daysLeft}d)`;
}
} else {
const months = Math.floor(remainingDays / 30);
const daysLeft = remainingDays % 30;

if (years > 2) {
return ` (${years}yrs, ${months}mo, ${daysLeft}d)`;
} else {
return ` (${years}yr, ${months}mo, ${daysLeft}d)`;
}
}
} else if (days > 30) {
const months = Math.floor(days / 30);
const daysLeft = days % 30;
return ` (${months}mo, ${daysLeft}d)`;
} else {
return ` (${days}d)`;
}
}

    // Function to get formatted month
    function getMonth(date) {
      const month = date.toLocaleString('default', { month: 'short' });
      const day = date.getDate();
      const year = date.getFullYear();
      // assign suffix to month
      let daySuffix;
      switch (day) {
        case 1:
        case 21:
        case 31:
          daySuffix = 'st';
          break;
        case 2:
        case 22:
          daySuffix = 'nd';
          break;
        case 3:
        case 23:
          daySuffix = 'rd';
          break;
        default:
          daySuffix = 'th';
      }
      return month + ' ' + day + daySuffix + ' ' + year;
    }

    // Function to process user data elements
    function processUserDataElements() {
      // Get all elements with id starting with "userdata_"
      const userDataElements = document.querySelectorAll('[id^="userdata_"]');

      // Loop through each element
      userDataElements.forEach(function(element) {
        // Get platform name from the element id
        const platform = element.id.replace('userdata_', '');

        // Determine the date based on the platform
        let date;
        switch (platform) {
          case 'steam':
            date = new Date(2019, 5, 23);
            break;
          case 'wakatime':
            date = new Date(2023, 9, 1);
            break;
          // Add more cases for other platforms if needed

          case 'lastfmspotify':
            // Special case for userdata_lastfmspotify
            date = {
              lastfm: new Date(2023, 6, 25),
              spotify: new Date(2022, 0, 20)
            };
            break;

          default:
            // Default date if platform not recognized
            date = new Date();
        }

        // Display the message in the element
        if (platform === 'lastfmspotify') {
          element.innerHTML = 'collecting last.fm since ' + getMonth(date.lastfm) + getDays(date.lastfm) + 
                               '<br>collecting spotify since ' + getMonth(date.spotify) + getDays(date.spotify);
        } else {
          element.textContent = 'collecting since ' + getMonth(date) + getDays(date);
        }
      });
    }

    // Call the function to process user data elements
    processUserDataElements();
  });
</script>



<script src="./config.js"></script>

<script src="./code/formats/formatting.js"></script>
<script src="./code/formats/birthday.js"></script>
<script src="./code/formats/time.js"></script>

<script src="./code/fetches/connections.js"></script>
<script src="./code/fetches/pronounspage.js"></script>
<script src="./code/fetches/updates.js"></script>

<script src="./code/horizontalScroll.js"></script>
<script src="./code/preference.js"></script>

<script src="./code/checkmobile.js"></script>
</body>
</html>